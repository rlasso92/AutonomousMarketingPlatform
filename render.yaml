services:
  - type: web
    name: autonomous-marketing-platform
    env: dotnet
    plan: starter
    region: virginia
    branch: main
    buildCommand: dotnet restore && dotnet publish src/AutonomousMarketingPlatform.Web/AutonomousMarketingPlatform.Web.csproj -c Release -o ./publish
    startCommand: cd publish && dotnet AutonomousMarketingPlatform.Web.dll
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ASPNETCORE_URLS
        value: http://0.0.0.0:$PORT
      - key: ConnectionStrings__DefaultConnection
        value: Host=dpg-d5a8afv5r7bs739m2vlg-a.virginia-postgres.render.com;Port=5432;Database=autonomousmarketingplatform;Username=admin;Password=0kAW5J0EWX3hR7GwDAhOUpv4ieV1IqN1;SSL Mode=Require;
      - key: Encryption__Key
        sync: false
      - key: N8n__BaseUrl
        value: https://n8n.bashpty.com
      - key: N8n__ApiUrl
        value: https://n8n.bashpty.com/api/v1
      - key: N8n__DefaultWebhookUrl
        value: https://n8n.bashpty.com/webhook/marketing-request
      - key: AI__UseMock
        value: "false"
      - key: AI__OpenAI__ApiKey
        sync: false
      - key: AI__OpenAI__Model
        value: gpt-4
      - key: MultiTenant__ValidationEnabled
        value: "true"

